
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://prophetverse.com/0.7.0/the-theory/">
      
      
        <link rel="prev" href="../mmm/budget_allocation/">
      
      
        <link rel="next" href="../reference/sktime/prophetverse/">
      
      
      <link rel="icon" href="../static/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>Theory - Prophetverse</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="https://unpkg.com/katex@0/dist/katex.min">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../ipymd/pandas.css">
    
      <link rel="stylesheet" href="../ipymd/cell-style.css">
    
      <link rel="stylesheet" href="../ipymd/pygments.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#prophetverse" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Prophetverse" class="md-header__button md-logo" aria-label="Prophetverse" data-md-component="logo">
      
  <img src="../static/logo-removebg.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Prophetverse
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Theory
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/felipeangelimvieira/prophetverse" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../tutorial/univariate/" class="md-tabs__link">
          
  
  
  Tutorial üìö

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../howto/" class="md-tabs__link">
          
  
  
  How-to üõ†Ô∏è

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../mmm/" class="md-tabs__link">
          
  
  
  Marketing Mix Modeling üöÄ

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  
  Mathematical formulation üìñ

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../reference/sktime/prophetverse/" class="md-tabs__link">
          
  
  
  Reference

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../development/development-guide/" class="md-tabs__link">
          
  
  
  Development

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../deprecation/" class="md-tabs__link">
        
  
  
    
  
  Deprecation Policy

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Prophetverse" class="md-nav__button md-logo" aria-label="Prophetverse" data-md-component="logo">
      
  <img src="../static/logo-removebg.png" alt="logo">

    </a>
    Prophetverse
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/felipeangelimvieira/prophetverse" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tutorial üìö
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Tutorial üìö
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial/univariate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Univariate Time Series
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial/hierarchical/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hierarchical Time Series
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial/count-data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Nonnegative timeseries
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial/tuning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hyperparameter tuning
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    How-to üõ†Ô∏è
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            How-to üõ†Ô∏è
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../howto/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../howto/custom-effects/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom Exogenous Effects ‚ú®
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../howto/custom-trend/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom Trend üåü
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../howto/composite-exogenous-effects/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Composite Exogenous Effects
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Marketing Mix Modeling üöÄ
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Marketing Mix Modeling üöÄ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mmm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mmm/fitting_and_calibration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Saturation, Calibration, and Unified Marketing Measurement
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mmm/budget_allocation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Budget Optimization
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Mathematical formulation üìñ
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Mathematical formulation üìñ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Theory
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Theory
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#likelihood" class="md-nav__link">
    <span class="md-ellipsis">
      Likelihood
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trend" class="md-nav__link">
    <span class="md-ellipsis">
      Trend
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Trend">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#linear-trend" class="md-nav__link">
    <span class="md-ellipsis">
      Linear trend
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Linear trend">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#original-formulation" class="md-nav__link">
    <span class="md-ellipsis">
      Original formulation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prophetverses-equivalent-formulation" class="md-nav__link">
    <span class="md-ellipsis">
      Prophetverse's equivalent formulation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logistic-trend" class="md-nav__link">
    <span class="md-ellipsis">
      Logistic trend
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#changepoint-priors" class="md-nav__link">
    <span class="md-ellipsis">
      Changepoint priors
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seasonality" class="md-nav__link">
    <span class="md-ellipsis">
      Seasonality
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Seasonality">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#matrix-formulation-of-fourier-series" class="md-nav__link">
    <span class="md-ellipsis">
      Matrix Formulation of Fourier Series
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multivariate-model" class="md-nav__link">
    <span class="md-ellipsis">
      Multivariate model
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" >
        
          
          <label class="md-nav__link" for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Sktime
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            Sktime
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sktime/prophetverse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prophetverse
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sktime/prophet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prophet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sktime/prophet_gamma/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ProphetGamma
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sktime/prophet_negbin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ProphetNegBinomial
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/sktime/hierarchical_prophet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hierarchical Prophet
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/inference_engine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Inference Engines
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/optimizers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Optimizers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/effects/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exogenous Effects
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/trends/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Trend models
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Development
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../development/development-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing to Prophetverse
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../deprecation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Deprecation Policy
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="prophetverse">Prophetverse</h1>
<p align="center">

<p align="center">
<img src="/static/prophetverse-universe.png">
</p>

<p align="center" style="font-size: smaller;">
Figure 1: Generalized Additive Models are versatile. Prophet is one of the many models that can be built on top of it.
The idea of Prophetverse is giving access to that universe.
</p>

</p>

<p><strong>Prophetverse</strong> leverages the <strong>Generalized Additive Model (GAM)</strong> idea in the original
Prophet model and extends it to be more flexible and customizable. The core principle of GAMs is to model the expected value <span class="arithmatex">\(y_{mean}\)</span> of 
the endogenous variable <span class="arithmatex">\(Y\)</span> as the sum of many functions <span class="arithmatex">\(\{f_i\}_{i=1}^n\)</span> of exogenous
variables <span class="arithmatex">\(\{x_i\}_{i=1}^n\)</span>. </p>
<div class="arithmatex">\[
y_{mean} = f_1(x_1) + f_2(x_2) + \ldots + f_n(t)\text{, }\quad n \in \mathbb{N}
\]</div>
<p>The innovation in Prophet is the use of Bayesian GAMs to model time series data. Instead of approximating the time series through auto-regressive models, Prophet treats it as a curve-fitting exercise. This approach results in fast, interpretable, and accurate forecasts. The Prophet formulation is:</p>
<div class="arithmatex">\[
y_{\text{mean}} = \begin{cases} y_{\text{mean}}(t) = \tau(t) + s(t) + h(t) + v(t) &amp; \text{if additive} \\ y_{\text{mean}}(t) = \tau(t) + \tau(t) \cdot s(t) + \tau(t) \cdot h(t) + \tau(t) \cdot v(t) &amp; \text{if multiplicative} \end{cases}
\]</div>
<p>where <span class="arithmatex">\(\tau(t)\)</span> is the trend component, <span class="arithmatex">\(s(t)\)</span> is the seasonality component,
<span class="arithmatex">\(h(t)\)</span> is the holiday component, and <span class="arithmatex">\(v(t)\)</span> is other regressors components. Those
components are hard-coded as linear in the original formulation of Faacebook Prophet, but in Prophetverse they are versatile and can be defined by the user. <strong>This is the first main difference
between Prophet and Prophetverse</strong>. The <span class="arithmatex">\(f_i\)</span> functions are defined by the <a href="https://prophetverse.com/effects-api/"><code>Effects API</code></a> 
, where the user can create their own components and priors, by using the already
available ones or by creating new <a href="https://prophetverse.com/reference/effects/"><code>BaseEffect</code></a> subclasses.</p>
<div class="arithmatex">\[\begin{align}
y_{mean} &amp;= \sum\limits_{i=1}^n f_i(x_i(t), \{f_j(x_j)\}_{j&lt;i}) \\
         &amp;= f_1(x_1(t)) + f_2(x_2(t), f_1(x_1(t))) + \ldots + f_n(t, \{f_j(x_j)\}_{j&lt;n})
\end{align}\]</div>
<p>where </p>
<ul>
<li>the first component <span class="arithmatex">\(f_1\)</span> accounts for the trend</li>
<li>the second component <span class="arithmatex">\(f_2\)</span> is other regression component that could interact with the trend <span class="arithmatex">\(f_1\)</span></li>
<li>the third component <span class="arithmatex">\(f_3\)</span> is another regression component that could interact with <span class="arithmatex">\(f_1\)</span>, and <span class="arithmatex">\(f_2\)</span> </li>
<li>And the next components can always interact with the previously defined components.</li>
</ul>
<p>This definition superseeds the
Prophet formulation because effects are ordered, so that the output of previous effects can be used as input for the next ones. This allows for complex interactions between exogenous variables.</p>
<h2 id="likelihood">Likelihood</h2>
<p>In the original Prophet, the likelihood is a Normal distribution, but in Prophetverse
it can be Normal, Gamma, or Negative Binomial. </p>
<div class="arithmatex">\[
y \sim \mathcal{likelihood}(\phi(\hat{y}_{mean}), \sigma^2)\quad \text{where} \quad
\sigma \sim HalfNormal(\sigma_{hyper})
\]</div>
<p>where <span class="arithmatex">\(\sigma_{hyper}\)</span> is a hyperparameter and <span class="arithmatex">\(\phi\)</span> is a function that maps the mean to the support of the likelihood. For normal
likelihood, <span class="arithmatex">\(\phi\)</span> is the identity function, but for Gamma and Negative Binomial, it is</p>
<div class="arithmatex">\[
\phi(k) = \begin{cases}
k &amp; \text{if } k &gt; z \\
z\exp(k-z) &amp; \text{if } k \leq z
\end{cases}
\]</div>
<p>for some small threshold <span class="arithmatex">\(z\)</span>. We set <span class="arithmatex">\(z = 10^{-5}\)</span> in our implementation. The reason for this
is to avoid zero or negative values in the support of the likelihood, which can lead to
error.</p>
<h2 id="trend">Trend</h2>
<p>There are mainly two types of trends supported: linear and logistic. We will first
take a look at the original mathematical formulation of Prophet's paper, and then
simplify it to obtain a simpler and more interpretable version. </p>
<h3 id="linear-trend">Linear trend</h3>
<h4 id="original-formulation">Original formulation</h4>
<p>The linear trend is modeled as a piecewise linear functions with changepoints. Let <span class="arithmatex">\(M\)</span> be
the number of changepoints, <span class="arithmatex">\(\delta \in \mathbb{R}^M\)</span> be the rate adjustment at each changepoint, <span class="arithmatex">\(\{\kappa_i\}_{i=1}^M\)</span>
be the changepoint times, and be <span class="arithmatex">\(a(t) \in \{0,1\}^M\)</span> be a vector which assumes, at each
index, 1 if the
corresponding changepoint is greater than <span class="arithmatex">\(t\)</span> and 0 otherwise. In addition, let <span class="arithmatex">\(k\)</span> represent
the global rate and <span class="arithmatex">\(m\)</span> the global offset. Then, the linear trend
is defined as:</p>
<div class="arithmatex">\[
\tau(t) = (k + a(t)^T\delta)t + (m + a(t)^T\gamma), \quad \text{where} \quad \gamma_i = \kappa_i\delta_i
\]</div>
<p>The first part accounts for the rate adjustment at each changepoint, and the second part
corrects the offset at each changepoint, so that the trend is continuous. </p>
<h4 id="prophetverses-equivalent-formulation">Prophetverse's equivalent formulation</h4>
<p>This can be
simplified as a first-order spline regression with <span class="arithmatex">\(M\)</span> knots (changepoints). Let 
<span class="arithmatex">\(b(t) \in \mathbb{R}^M\)</span> be a vector so that <span class="arithmatex">\(b(t)_i = (t - \kappa_i)_+\)</span> (the positive part of
<span class="arithmatex">\(t - \kappa_i\)</span>). Then, the piecewise linear trend value for time <span class="arithmatex">\(t\)</span> can be written as:</p>
<div class="arithmatex">\[
\tau(t) = b(t)^T \delta + kt + m
\]</div>
<p>We can also write the trend for all <span class="arithmatex">\(t \in \{t_1,\dots, t_T\}\)</span> as a matrix multiplication. Let
<span class="arithmatex">\(\mathbf{B} \in \mathbb{R}^{T \times M+2}\)</span> be the matrix whose rows are <span class="arithmatex">\(b'(t) = \left[ b(t), t, 1 \right]\)</span> 
for each time <span class="arithmatex">\(t\)</span>. In other words, it is the spline basis matrix. The <span class="arithmatex">\(t\)</span> and <span class="arithmatex">\(1\)</span> at the end of the vector are included to account for the
global rate and offset. Furthermore, consider the vector <span class="arithmatex">\(\delta' = \left[ \delta, k, m \right]\)</span>.
Then, the trend vector <span class="arithmatex">\(G \in \mathbb{R}^T\)</span>, <span class="arithmatex">\(G_i = \tau(\mathbf{t}_i)\)</span>, can be written as:</p>
<div class="arithmatex">\[\begin{align}
G &amp;= \mathbf{B}\delta' \\
\end{align}\]</div>
<div class="arithmatex">\[\begin{align}
G &amp;=  \begin{bmatrix}
(t_0 - \kappa_0)_+ &amp; (t_0 - \kappa_1)_+ &amp; \ldots &amp; (t_0 - \kappa_{M-1})_+ &amp; t_0 &amp; 1 \\
(t_1 - \kappa_0)_+ &amp; (t_1 - \kappa_1)_+ &amp; \ldots &amp; (t_1 - \kappa_{M-1})_+ &amp; t_1 &amp; 1 \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots \\
(t_{T-1} - \kappa_0)_+ &amp; (t_{T-1} - \kappa_1)_+ &amp; \ldots &amp; (t_{T-1} - \kappa_{M-1})_+ &amp; t_{T-1} &amp; 1 \\
\end{bmatrix} \begin{bmatrix}
\delta_0 \\
\delta_1 \\
\vdots \\
\delta_{M-1} \\
k \\
m \\
\end{bmatrix}
\end{align}\]</div>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>One possible realization of <span class="arithmatex">\(\mathbf{B}\)</span> is:</p>
<div class="arithmatex">\[
\begin{bmatrix}
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 1 \\
1 &amp; 0 &amp; 0 &amp; 0 &amp; 2 &amp; 1 \\
2 &amp; 1 &amp; 0 &amp; 0 &amp; 3 &amp; 1 \\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
T-1 &amp; T-2 &amp; T-3 &amp; T-4 &amp; T-1 &amp; 1 \\
\end{bmatrix}
\]</div>
</div>
<h3 id="logistic-trend">Logistic trend</h3>
<p>The logistic trend of the original model uses the piecewise logistic linear trend to 
change the rate at which
<span class="arithmatex">\(t\)</span> grows. We will not explain the mathematical formulation of the original paper here,
and will already leverage what we have learned about the linear trend to simplify it.</p>
<div class="arithmatex">\[
G = \frac{C}{1 + \exp(-\mathbf{B}\delta')}
\]</div>
<p>where <span class="arithmatex">\(C\)</span> is the <strong>logistic capacity</strong>, which should be passed as input to Prophet, but
<strong>is a random variable in Prophetverse</strong>.</p>
<h3 id="changepoint-priors">Changepoint priors</h3>
<p>A Laplace prior is put on the rate adjustment <span class="arithmatex">\(\delta_i \sim Laplace(0, \sigma_{\delta})\)</span>
where <span class="arithmatex">\(\sigma_{\delta}\)</span> is a hyperparameter. The changepoint times <span class="arithmatex">\(\kappa_i\)</span> can be 
predefined by the user, or can be uniformly distributed in the training data. The offset
and rate prior location are set in a "smart" way, by checking analytically what would
be the values that fit the maximum and minimum points of the time series. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although those trend are the ones that come with the library, the user can
define any trend, including a trend that depends on some exogenous variable. 
Flexibility is the key here.</p>
</div>
<h2 id="seasonality">Seasonality</h2>
<p>To model seasonality, Prophetverse uses a Fourier series to approximate periodic functions, allowing the model to fit complex seasonal patterns flexibly. This approach involves determining the number of Fourier terms (<code>K</code>), which corresponds to the complexity of the seasonality. The formula for a seasonal component <code>s(t)</code> in terms of a Fourier series is given as:</p>
<div class="arithmatex">\[
s(t) = \sum_{k=1}^K \left( a_k \cos\left(\frac{2\pi kt}{P}\right) + b_k \sin\left(\frac{2\pi kt}{P}\right) \right)
\]</div>
<p>Here, <code>P</code> is the period (e.g., 365.25 for yearly seasonality), and <span class="arithmatex">\(a_k\)</span> and <span class="arithmatex">\(b_k\)</span> are the Fourier coefficients that the model estimates. The choice of <code>K</code> depends on the granularity of the seasonal changes one wishes to capture.
A Normal prior is placed on the coefficients, <span class="arithmatex">\(a_k, b_k \sim \mathcal{N}(0, \sigma_s)\)</span>, where <span class="arithmatex">\(\sigma_s\)</span> is a hyperparameter.</p>
<p>See <a href="/reference/effects/#prophetverse.effects.LinearFourierSeasonality"><code>LinearFourierSeasonality</code></a> for more details on the hyperparameters of the effect</p>
<h3 id="matrix-formulation-of-fourier-series">Matrix Formulation of Fourier Series</h3>
<p>To efficiently compute the seasonality for multiple time points, we can represent the Fourier series in a matrix form. This method is especially useful for handling large datasets and simplifies the implementation of the model in computational software.
Let <span class="arithmatex">\(T\)</span> be the number of time points, and create a design matrix <span class="arithmatex">\(X\)</span> of size <span class="arithmatex">\(T \times 2K\)</span>. Each row of <span class="arithmatex">\(X\)</span> corresponds to a time point and contains all Fourier basis functions evaluated at that time:</p>
<div class="arithmatex">\[
\mathbf{X} = \begin{bmatrix}
\cos\left(\frac{2\pi \cdot 1 \cdot t_1}{P}\right) &amp; \sin\left(\frac{2\pi \cdot 1 \cdot t_1}{P}\right) &amp; \cdots &amp; \cos\left(\frac{2\pi \cdot K \cdot t_1}{P}\right) &amp; \sin\left(\frac{2\pi \cdot K \cdot t_1}{P}\right) \\
\cos\left(\frac{2\pi \cdot 1 \cdot t_2}{P}\right) &amp; \sin\left(\frac{2\pi \cdot 1 \cdot t_2}{P}\right) &amp; \cdots &amp; \cos\left(\frac{2\pi \cdot K \cdot t_2}{P}\right) &amp; \sin\left(\frac{2\pi \cdot K \cdot t_2}{P}\right) \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots \\
\cos\left(\frac{2\pi \cdot 1 \cdot t_T}{P}\right) &amp; \sin\left(\frac{2\pi \cdot 1 \cdot t_T}{P}\right) &amp; \cdots &amp; \cos\left(\frac{2\pi \cdot K \cdot t_T}{P}\right) &amp; \sin\left(\frac{2\pi \cdot K \cdot t_T}{P}\right)
\end{bmatrix}
\]</div>
<p><strong>Coefficient Vector</strong>:</p>
<p>Define a vector <span class="arithmatex">\(\beta\)</span> of length <code>2K</code> containing the coefficients <span class="arithmatex">\(a_1, b_1, \dots, a_K, b_K\)</span>:</p>
<div class="arithmatex">\[
\mathbf{\beta} = \begin{bmatrix}
a_1 \\
b_1 \\
\vdots \\
a_K \\
b_K
\end{bmatrix}
\]</div>
<p>The seasonality for all time points can then be computed through the matrix product of <span class="arithmatex">\(X\)</span> and <span class="arithmatex">\(\beta\)</span>:</p>
<div class="arithmatex">\[
\mathbf{s} = \mathbf{X} \mathbf{\beta}
\]</div>
<p>Each element of vector <span class="arithmatex">\(s\)</span>, denoted as <span class="arithmatex">\(s_i\)</span>, represents the seasonality at time <span class="arithmatex">\(t_i\)</span>.</p>
<p>This matrix approach not only makes the computation faster and more scalable but also simplifies integration with other components of the forecasting model. One drawback is
that it assumes a constant seasonality, but an user can also define a seasonality that
changes with time in Prophetverse, by creating a custom <code>Effect</code> class.</p>
<h2 id="multivariate-model">Multivariate model</h2>
<p>Prophetverse also supports multivariate forecasting. In this case, the model is
essentially the same, but for now only Normal Likelihood is supported. Depending on
the usage of the library, we may add other likelihoods in the future (please open an
issue if you need it!). In that case, all other components are estimated in the same way,
but the likelihood is a multivariate distribution. The mean of the distribution is
a vector, and the covariance matrix prior is a LKJ distribution.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy", "navigation.tabs", "navigation.instant", "navigation.instant.progress", "search", "toc.integrate", "toc.follow"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>